<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../libs/pure-min.css">
    <link rel="stylesheet" href="../libs/normalize.css">
    <link rel="stylesheet" href="page1.css">
    <script type="text/javascript" src="../libs/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="../libs/console.min.js"></script>
</head>
<body>
<div id="pages">
    <div class="prue-g">
        <div class="pure-u-1">
            1
        </div>
        <div class="pure-u-1">
            2
        </div>
        <div class="pure-u-1">
            3
        </div>
    </div>
</div>
<script type="text/javascript">
    function ScrollPage(cfg) {
        //0,上下;1,左右
        this.direction = 0;
        this.cfg = cfg;
        this.pages = cfg.container.find(">div");
        this.maxx = 0;
        this.maxy = 0;
        this.timer = null;
        this.screenHeight = $(window).height();
        this.screenWidth = $(window).width();
        //ie,chrome
        if ("onmousewheel" in document) {
            this.cfg.container.bind("mousewheel", this.onMousewheel.bind(this));
        }
        else {
            //FF
            this.cfg.container.bind("DOMMouseScroll", this.onMousewheel.bind(this));
        }

        //on inited
        if (cfg && cfg.onInited) cfg.onInited.bind(this)();
    }
    ScrollPage.prototype = {
        show: function (id) {

        },
        onMousewheel: function (evt) {
            if (this.timer) {
                clearTimeout(this.timer);
                this.timer = null;
            }
            this.timer = setTimeout(function () {

                console.info(evt.type);
                var delta=evt.originalEvent.wheelDelta||evt.originalEvent.detail;
                console.info(delta);
                var direction = {x: 0, y: delta};
                if (this.direction === 0) {
                    var curY = this.pages.position().top;
                    var targetY;
                    if (direction.y > 0) {
                        //up
                        targetY = curY - this.screenHeight;
                        if (targetY < (this.screenHeight - this.pages.height())) targetY += this.screenHeight;
                    }
                    else {
                        targetY = curY + this.screenHeight;
                        if (targetY > 0) targetY = 0;
                    }
                    this.pages.css({
                        top: targetY
                    });
                }
                else {
                }
                if (this.cfg.onChange) this.cfg.onChange(direction);
            }.bind(this), 400);

        }
    };

    var page = new ScrollPage({
        container: $("#pages"),
        onInited: function () {
            $("#pages>div>div").height($(window).height());
            this.maxy = $("#pages>div").height();
            console.info(this.maxy);
        },
        onChange: function (dire) {
            console.info(dire.x+":"+dire.y);
        }
    })
</script>
</body>
</html>